
[y, fs]=audioread('cello-phrase.wav');
y = y(1:.5*fs);

figure;
plot(y);


mpdict = wmpdictionary(length(y),'lstcpt',{'sin'});
omp_sig = my_omp(2,mpdict,y);

figure;
my_omp_sig = mpdict * omp_sig;
plot(my_omp_sig);

yn = awgn(y,10,'measured');

% [yfit,r,coeff,iopt,qual] = wmpalg('OMP',yn,mpdict,'typeplot','movie','stepplot',1, 'itermax',15,'maxerr',{'L1',33});

audiowrite('1.original.wav',yn,fs);
audiowrite('2.noisy.wav',yn,fs);
audiowrite('3.omp_piano.wav',my_omp_sig,fs);
audiowrite('rec_piano.wav',yfit,fs);